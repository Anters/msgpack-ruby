<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.3
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'>
<h1>MessagePack</h1>

<p><a href="http://msgpack.org">MessagePack</a> is an efficient binary
serialization format. It lets you exchange data among multiple languages
like JSON but it's faster and smaller. For example, small integers (like
flags or error code) are encoded into a single byte, and typical short
strings only require an extra byte in addition to the strings themselves.</p>

<p>If you ever wished to use JSON for convenience (storing an image with
metadata) but could not for technical reasons (binary data, size,
speed...), MessagePack is a perfect replacement.</p>

<pre class="code ruby"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>msgpack</span><span class='tstring_end'>'</span></span>
<span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_msgpack'>to_msgpack</span>  <span class='comment'>#=&gt; &quot;\x93\x01\x02\x03&quot;
</span><span class='const'>MessagePack</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>   <span class='comment'>#=&gt; [1,2,3]</span></code></pre>

<p>Use RubyGems to install:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_msgpack'>msgpack</span></code></pre>

<h1>Use cases</h1>
<ul><li>
<p>Store objects efficiently serialized by msgpack on memcached or Redis</p>
<ul><li>
<p>In fact Redis supports msgpack in <a
href="http://redis.io/commands/eval">EVAL-scripts</a></p>
</li></ul>
</li><li>
<p>Upload data in efficient format from mobile devices such as smartphones</p>
<ul><li>
<p>MessagePack works on iPhone/iPad and Android. See also <a
href="https://github.com/msgpack/msgpack-objectivec">Objective-C</a> and <a
href="https://github.com/msgpack/msgpack-java">Java</a> implementations</p>
</li></ul>
</li><li>
<p>Design a portable protocol to communicate with embedded devices</p>
<ul><li>
<p>Check also <a href="http://fluentd.org/">Fluentd</a> which is a log
collector which uses msgpack for the log format (they say it uses JSON but
actually it's msgpack, which is compatible with JSON)</p>
</li></ul>
</li><li>
<p>Exchange objects between software components written in different languages</p>
<ul><li>
<p>You'll need a flexible but efficient format so that components exchange
objects while keeping compatibility</p>
</li></ul>
</li></ul>

<h1>Portability</h1>

<p>MessagePack for Ruby should run on x86, ARM, PowerPC, SPARC and other CPU
architectures.</p>

<p>And it works with MRI (CRuby) and Rubinius. Patches to improve portability
is highly welcomed.</p>

<h1>Serializing objects</h1>

<p>Use <b>MessagePack.pack</b> or <b>to_msgpack</b>:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>msgpack</span><span class='tstring_end'>'</span></span>
<span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='const'>MessagePack</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='id identifier rubyid_obj'>obj</span><span class='rparen'>)</span>  <span class='comment'># or
</span><span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_obj'>obj</span><span class='period'>.</span><span class='id identifier rubyid_to_msgpack'>to_msgpack</span></code></pre>

<h2>Streaming serialization</h2>

<p>Packer provides advanced API to serialize objects in streaming style:</p>

<pre class="code ruby"><code><span class='comment'># serialize a 2-element array [e1, e2]
</span><span class='id identifier rubyid_pk'>pk</span> <span class='op'>=</span> <span class='const'>MessagePack</span><span class='op'>::</span><span class='const'>Packer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span>
<span class='id identifier rubyid_pk'>pk</span><span class='period'>.</span><span class='id identifier rubyid_write_array_header'>write_array_header</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_e1'>e1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_e2'>e2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flush'>flush</span></code></pre>

<p>See <a href="http://ruby.msgpack.org/MessagePack/Packer.html">API
reference</a> for details.</p>

<h1>Deserializing objects</h1>

<p>Use <b>MessagePack.unpack</b>:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>msgpack</span><span class='tstring_end'>'</span></span>
<span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='const'>MessagePack</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span></code></pre>

<h2>Streaming deserialization</h2>

<p>Unpacker provides advanced API to deserialize objects in streaming style:</p>

<pre class="code ruby"><code><span class='comment'># deserialize objects from an IO
</span><span class='id identifier rubyid_u'>u</span> <span class='op'>=</span> <span class='const'>MessagePack</span><span class='op'>::</span><span class='const'>Unpacker</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span>
<span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_obj'>obj</span><span class='op'>|</span>
  <span class='comment'># ...
</span><span class='kw'>end</span></code></pre>

<p>or event-driven style which works well with EventMachine:</p>

<pre class="code ruby"><code><span class='comment'># event-driven deserialization
</span><span class='kw'>def</span> <span class='id identifier rubyid_on_read'>on_read</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
  <span class='ivar'>@u</span> <span class='op'>||=</span> <span class='const'>MessagePack</span><span class='op'>::</span><span class='const'>Unpacker</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@u</span><span class='period'>.</span><span class='id identifier rubyid_feed_each'>feed_each</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_obj'>obj</span><span class='op'>|</span>
     <span class='comment'># ...
</span>  <span class='rbrace'>}</span>
<span class='kw'>end</span></code></pre>

<p>See <a href="http://ruby.msgpack.org/MessagePack/Unpacker.html">API
reference</a> for details.</p>

<h1>Buffer API</h1>

<p>MessagePack for Ruby provides a buffer API so that you can read or write
data by hand, not via Packer or Unpacker API.</p>

<p>This <a
href="http://ruby.msgpack.org/MessagePack/Buffer.html">MessagePack::Buffer</a>
is backed with a fixed-length shared memory pool which is very fast for
small data (&lt;= 4KB), and has zero-copy capability which significantly
affects performance to handle large binary data.</p>

<h1>Copyright</h1>
<table class="rdoc-list"><tr><td class="rdoc-term"><p>Author</p></td>
<td>
<p>FURUHASHI Sadayuki &lt;frsyuki@gmail.com&gt;</p>
</td></tr><tr><td class="rdoc-term"><p>Copyright</p></td>
<td>
<p>Copyright (c) 2008-2012 FURUHASHI Sadayuki</p>
</td></tr><tr><td class="rdoc-term"><p>License</p></td>
<td>
<p>Apache License, Version 2.0</p>
</td></tr></table>
</div></div>

    <div id="footer">
  Generated on Fri Mar 15 11:27:20 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.3 (ruby-1.9.3).
</div>

  </body>
</html>